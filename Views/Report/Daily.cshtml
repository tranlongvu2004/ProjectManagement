@model CreateReportViewModel

<form asp-controller="Report" asp-action="UploadDaily" method="post">
    <input type="hidden" name="ProjectId" value="@Model.ProjectId" />
    <input type="hidden" name="ReportType" value="daily" />

    <h5>Members Report</h5>

    @for (int i = 0; i < Model.Members.Count; i++)
    {
        <div class="border p-3 mb-3">
            <strong>@Model.Members[i].FullName</strong>

            <input type="hidden" name="Members[@i].UserId"
                   value="@Model.Members[i].UserId" />
            <input type="hidden" name="Members[@i].FullName"
                   value="@Model.Members[i].FullName" />

            <input class="form-control mb-2"
                   name="Members[@i].Task"
                   placeholder="Task / Plan" />

            <input class="form-control mb-2"
                   name="Members[@i].Actual"
                   placeholder="Actual" />

            <input class="form-control mb-2"
                   type="number"
                   name="Members[@i].ProgressPercent"
                   placeholder="Progress (%)" />

        </div>
    }

    <button type="submit" class="btn btn-primary">
        Submit Report
    </button>
</form>


<script>
    $("#dailyReportForm").submit(function (e) {
        e.preventDefault();

        $.ajax({
            url: '/Report/UploadDaily',
            type: 'POST',
            data: $(this).serialize(),
            success: function (res) {
                if (res.success) {
                    alert(res.message);
                    window.location.href =
                        `/Report/ViewReport/${res.reportId}`;
                } else {
                    alert(res.message);
                }
            }
        });
    });
</script>

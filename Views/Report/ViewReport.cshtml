@model List<CreateReportViewModel>
<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />

<h2 class="mb-4">📊 Team Performance Reports</h2>

@if (!Model.Any())
{
    <div class="alert alert-info">
        No reports available.
    </div>
}
else
{
    <div class="accordion" id="reportAccordion">

        @for (int i = 0; i < Model.Count; i++)
        {
            var report = Model[i];
            var collapseId = $"collapse{i}";
            var headingId = $"heading{i}";

            <div class="accordion-item mb-2">
                <h2 class="accordion-header" id="@headingId">
                    <button class="accordion-button collapsed"
                            type="button"
                            data-bs-toggle="collapse"
                            data-bs-target="#@collapseId">

                        <strong>Report: </strong>
                        <span class="ms-3 text-muted">
                            📅 @report.CreatedAt?.ToString("dd/MM/yyyy HH:mm")
                        </span>
                    </button>
                </h2>

                <div id="@collapseId"
                     class="accordion-collapse collapse"
                     data-bs-parent="#reportAccordion">

                    <div class="accordion-body">

                        <table class="table table-bordered text-center align-middle">
                            <tr class="fw-semibold">
                                <th>Members</th>
                                @foreach (var m in report.Members)
                                {
                                    <th>@m.FullName</th>
                                }
                            </tr>

                            <tr>
                                <th>Task / Plan</th>
                                @foreach (var m in report.Members)
                                {
                                    <td>@m.Task</td>
                                }
                            </tr>

                            <tr>
                                <th>Actual</th>
                                @foreach (var m in report.Members)
                                {
                                    <td>@m.Actual</td>
                                }
                            </tr>

                            <tr>
                                <th>Progress %</th>
                                @foreach (var m in report.Members)
                                {
                                    <td>@(m.ProgressPercent ?? 0)%</td>
                                }
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        }
    </div>
}
